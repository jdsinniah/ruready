<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd">
    <property name="now" value="now()" dbms="postgres"/>
    
    <changeSet id="0" author="James Dario Sinniah">
        <createTable schemaName="public" tableName="user">
            <column name="id" type="int" defaultOnNull="false"/>
            <column name="name" type="varchar(50)" defaultOnNull="false"/>
            <column name="lastname" type="varchar(50)" defaultOnNull="false"/>
            <column name="email" type="varchar(50)" defaultOnNull="false"/>
            <column name="password" type="char(64)" defaultOnNull="false"/>
        </createTable>

        <addPrimaryKey schemaName="public"
                       tableName="user"
                       columnNames="id"
                       constraintName="pk_user"/>

        <addAutoIncrement columnDataType="int"
                          columnName="id"
                          incrementBy="1"
                          schemaName="public"
                          tableName="user"/>
    </changeSet>

    <changeSet id="1" author="James Dario Sinniah">
        <addColumn tableName="user">
            <column name="certified" type="boolean" defaultValueBoolean="false"/>
        </addColumn>
    </changeSet>
    
    <changeSet id="2" author="James Dario Sinniah">
        <createTable tableName="university">
            <column name="id" type="int" defaultOnNull="false" />
            <column name="name" type="varchar(100)" defaultOnNull="false"/>
        </createTable>

        <addPrimaryKey schemaName="public"
                       tableName="university"
                       columnNames="id"
                       constraintName="pk_university"/>

        <addAutoIncrement columnDataType="int"
                          columnName="id"
                          incrementBy="1"
                          schemaName="public"
                          tableName="university"/>
        <addColumn tableName="user">
            <column name="university_id" type="int" defaultOnNull="true"/>
        </addColumn>
        <addForeignKeyConstraint baseTableName="user" baseColumnNames="university_id" constraintName="user_university_constraint"
                                 referencedTableName="university"
                                 referencedColumnNames="id"/>
    </changeSet>

    <changeSet id="3" author="James Dario Sinniah">
        <createTable tableName="course">
            <column name="id" type="int" defaultOnNull="false" />
            <column name="name" type="varchar(100)" defaultOnNull="false"/>
        </createTable>

        <addPrimaryKey schemaName="public"
                       tableName="course"
                       columnNames="id"
                       constraintName="pk_course"/>

        <addAutoIncrement columnDataType="int"
                          columnName="id"
                          incrementBy="1"
                          schemaName="public"
                          tableName="course"/>

        <addColumn tableName="user">
            <column name="course_id" type="int" defaultOnNull="true"/>
        </addColumn>
        <addForeignKeyConstraint baseTableName="user" baseColumnNames="course_id" constraintName="user_course_constraint"
                                 referencedTableName="course"
                                 referencedColumnNames="id"/>

    </changeSet>

    <changeSet id="4" author="James Dario Sinniah">
        <addColumn tableName="course">
            <column name="university_id" type="int" defaultOnNull="false"/>
        </addColumn>

        <addForeignKeyConstraint baseTableName="course" baseColumnNames="university_id" constraintName="course_university_constraint"
                                 referencedTableName="university"
                                 referencedColumnNames="id"/>
    </changeSet>

</databaseChangeLog>